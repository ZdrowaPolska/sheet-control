
<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è Google Sheets</title>
</head>
<body style="font-family: sans-serif; max-width: 600px; margin: 40px auto;">
  <h2>üìä –ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è Google Sheets</h2>
  <p>–ú–æ–∂–ª–∏–≤—ñ –¥—ñ—ó (action):</p>
  <ul>
    <li><code>addColumn</code> ‚Äì –¥–æ–¥–∞—Ç–∏ —Å—Ç–æ–≤–ø–µ—Ü—å —ñ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º</li>
    <li><code>setCellValue</code> ‚Äì –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –∫–æ–º—ñ—Ä–∫—É</li>
    <li><code>readSheet</code> ‚Äì –∑—á–∏—Ç–∞—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ –∑ –∞—Ä–∫—É—à–∞</li>
    <li><code>updateRow</code> ‚Äì –æ–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ —Ü—ñ–ª–æ–º—É —Ä—è–¥–∫—É</li>
    <li><code>deleteColumn</code> ‚Äì –≤–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–æ–≤–ø–µ—Ü—å –∑–∞ –Ω–∞–∑–≤–æ—é</li>
  </ul>

  <form id="controlForm">
    <label>
      üìå <strong>–î—ñ—è (action):</strong><br>
      <input type="text" name="action" value="addColumn" required style="width: 100%;">
    </label><br><br>

    <label>
      üóÇ <strong>–ù–∞–∑–≤–∞ –∞—Ä–∫—É—à–∞ (sheetName):</strong><br>
      <input type="text" name="sheetName" value="–õ–∏—Å—Ç1" required style="width: 100%;">
    </label><br><br>

    <label>
      üõ† <strong>–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ (JSON):</strong><br>
      <textarea name="params" rows="8" style="width: 100%;">{
  "columnName": "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π —Å–∞–π—Ç"
}</textarea>
    </label><br><br>

    <button type="submit">üöÄ –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç</button>
  </form>

  <div id="result" style="margin-top: 20px; white-space: pre-wrap;"></div>

  <script>
    const form = document.getElementById('controlForm');
    const resultBox = document.getElementById('result');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const action = form.action.value.trim();
      const sheetName = form.sheetName.value.trim();
      let params;
      try {
        params = JSON.parse(form.params.value);
      } catch (err) {
        resultBox.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞ –≤ JSON –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö: ' + err.message;
        return;
      }

      const payload = {
        action,
        sheetName,
        params
      };

      try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbwHSdL7NGw70GlrciuSbwxiPxAgGttqDf9AFpRbQKTszeRM3hC73_vAyQjd9CkjAWiiIA/exec", {
          method: 'POST',
          body: JSON.stringify(payload),
          headers: {
            'Content-Type': 'application/json'
          }
        });
        const json = await res.json();
        resultBox.textContent = json.success ? '‚úÖ –£—Å–ø—ñ—Ö:\n' + JSON.stringify(json.result, null, 2) : '‚ùå –ü–æ–º–∏–ª–∫–∞:\n' + json.error;
      } catch (err) {
        resultBox.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Ç—ñ: ' + err.message;
      }
    });
  </script>
</body>
</html>
